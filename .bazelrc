# Hermetic builds: don't inherit host env
build --incompatible_strict_action_env

# Go race detector config
build:race --@io_bazel_rules_go//go/config:race

# Test output
test --test_output=errors

# Pass HOME to local tests (needed by lint for cache dirs and Go SDK discovery)
test --test_env=HOME

# CI config
build:ci --repository_cache=~/.cache/bazel-repo
build:ci --disk_cache=~/.cache/bazel-disk
test:ci --test_output=all
test:ci --test_env=DISCORD_BOT_TOKEN
test:ci --test_env=DISCORD_TEST_CHANNEL_ID

# Integration tests (run manually, require network + credentials)
test:integration --test_tag_filters=integration
test:integration --test_env=DISCORD_BOT_TOKEN
test:integration --test_env=DISCORD_TEST_CHANNEL_ID

# Coverage config
coverage --combined_report=lcov
coverage --instrumentation_filter=//internal/
